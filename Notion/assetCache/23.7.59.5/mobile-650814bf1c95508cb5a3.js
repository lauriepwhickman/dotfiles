(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{Acox:function(e,t,n){"use strict";n.r(t);n("ioFf"),n("rGqo");var r=n("q1tI"),i=n("ikHm"),o=n("y6Dp"),s=n("mF3+"),a=n("wpmu"),l=n("G4cA"),c=n("g4rC"),d=n("6WtK"),h=n("i3uR"),m=n("wldR"),u=n("LUuO"),p=n("wZk+"),g=n("stZG"),b=n("MvRd"),f=n("C7oc"),S=n("nM47"),y=n("FcJC"),v=n("6rsX"),k=n("TmDR"),w=n("uUOz"),O=n("Wae9"),E=n("MeYt"),C=n("7M94"),T=n("AXh+"),P=n("d9nj"),M=n("VOS9"),B=n("gbGO"),I=n("QcDD"),x=n("BJyN");function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class A extends m.a{constructor(){super(...arguments),this.renderOrigin=e=>{const{device:t}=this.environment;return r.createElement(E.a,Object.assign({style:this.getButtonStyle(),mobileFeedback:t.isMobile},e),s.a.dots({width:18,height:18}))},this.renderPopup=()=>{const{device:e}=this.environment,{store:t}=this.props,n={environment:this.environment,blocks:[t]};let i;return i=e.isMobile?{menuType:B.b.MenuType.ActionSheet}:{menuType:B.b.MenuType.Popup,width:210,maxHeight:"80vh"},r.createElement(B.b,Object.assign({},i),r.createElement(M.a,{sections:x.m,onAccept:this.handleAccept,context:n}))},this.handleClick=()=>{v.e(this.environment),o.dd(this.environment)},this.handleDismiss=()=>{this.props.buttonPopupStore.setState(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.props.buttonPopupStore.state,{open:!1}))},this.handleAccept=e=>{const{currentBlockStore:t}=I.default.state;if(t){const n=t.getType();n&&o.p(this.environment,{analyticsName:e.analyticsName,from:"public_topbar_more_menu",block_type:n})}e.closeParentMenu&&this.handleDismiss()}}renderComponent(){const{device:e}=this.environment;return r.createElement(h.a,{popupType:e.isMobile?h.a.PopupType.SlideUp:h.a.PopupType.Popup,buttonPopupStore:this.props.buttonPopupStore,renderOrigin:this.renderOrigin,onClick:this.handleClick,render:this.renderPopup,originGap:8})}getButtonStyle(){const{device:e}=this.environment;return e.isMobile?{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",marginLeft:8,marginRight:8}:{display:"flex",alignItems:"center",justifyContent:"center",width:32,height:28,borderRadius:3}}}var R=A,D=n("4aFz"),W=n("sdlW"),L=n("Sb6f"),U=n("G414"),z=n("Oy36"),q=n("OxuQ"),N=n("HSWF"),V=n("id5p"),Q=n("zmp8"),G=n("H4VD"),H=n("/0g+"),_=n("MBf9"),X=n("h5Kq"),Z=n("HRSx"),Y=n("ov3o"),J=n("58VE"),K=n("HTHG"),$=n("UcZb"),ee=n("Rtjx"),te=n("JBsN"),ne=n("J9+s"),re=n("Hq/H"),ie=n("wS9/"),oe=n("qX+M"),se=n("bLTx"),ae=n("gHFd");function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class de extends m.a{constructor(){super(...arguments),this.storeTypes={shareButtonPopupStore:c.a},this.handleOpenQuickFind=()=>{D.b({environment:this.environment,analyticsFrom:"public-page-topbar"})},this.handleShareClick=()=>{o.Zc(this.environment),S.f(this.environment)},this.handleTopbarClick=()=>{v.e(this.environment)},this.navigateToFirstSpace=()=>{const{currentUserRootStore:e,currentUserSettingsStore:t}=I.default.state;e&&t&&W.n({environment:this.environment,userRootStore:e,userSettingsStore:t})},this.handleMoveToClick=e=>{U.d({blocks:[this.props.store],analyticsFrom:"quick_add",onAccept:this.handleMoveToAccept,isAddTo:!0})},this.handleMoveToAccept=e=>{const{currentSpaceStore:t}=I.default.state;t&&this.props.saveParent&&N.A({currentUserId:this.environment.currentUser.id,spaceId:t.id,value:e}),o.oc(this.environment)},this.handleCancelQuickAdd=e=>{const t=I.default.state.currentBlockStore,n=Y.a.state.lastPageId;t&&n&&(G.navigateToBlock({environment:this.environment,store:a.a.createChildStore(t,{table:Z.b,id:n}),showMoveTo:!1,saveParent:!1}),_.createAndCommit(this.environment,e=>{H.b({environment:this.environment,blocks:[t],transaction:e})}))}}renderComponent(){const{store:e}=this.props,{WindowSizeStore:t,device:n}=this.environment,i=Object(T.g)(this.environment,this.props.store);return r.createElement(g.a,{capture:!0,render:o=>r.createElement("div",Object.assign({},o,{style:this.getWrapStyle()}),i?this.renderPublicPageTopbar():this.renderNormalTopbar(),e.canEdit()&&n.isPhone&&r.createElement(k.a,{store:this.props.store,isMobile:!0,key:this.props.store.id}),this.props.isOffline&&r.createElement(X.b,{type:X.a.White,isMobile:!0},r.createElement("div",{style:{display:"flex",alignItems:"center",width:"100%",paddingLeft:t.getSafePaddingLeftCSS(10),paddingRight:t.getSafePaddingRightCSS(14)}},s.a.mobileOffline({width:26,marginRight:12}),r.createElement("div",null,r.createElement(ne.FormattedMessage,{defaultMessage:"You're offline",id:"topbarMobile.offline.message"})))),r.createElement(u.a,{banners:this.props.banners,isMobile:!0}))})}renderPublicPageTopbar(){const{store:e}=this.props;return r.createElement("div",{onClick:this.handleTopbarClick,style:this.getStyle(),className:C.Mb},this.environment.currentUser.isLoggedIn()&&r.createElement(r.Fragment,null,r.createElement(E.a,{style:{display:"flex",alignItems:"center",height:"100%",paddingLeft:14,paddingRight:14,fontWeight:L.a.fontWeight.medium,color:this.theme.regularTextColor},mobileFeedback:!0,onClick:this.navigateToFirstSpace},r.createElement(ne.FormattedMessage,{defaultMessage:"Back",id:"topbarMobile.backButton.label"})),r.createElement("div",{style:{height:18,width:1,flexShrink:0,marginRight:6,background:this.theme.darkDividerColor}})),r.createElement(d.a,{store:this.props.store,style:this.getBreadcrumbsStyle(),maxAncestorCount:1,showCurrentPageControls:!1,ancestorMaxWidth:100,currentPageMaxWidth:220,isMobile:!0}),r.createElement("div",{style:{flexGrow:1,flexShrink:1}}),r.createElement(P.a,{onClick:this.handleOpenQuickFind},s.a.searchThick({width:20,height:20})),r.createElement(R,{store:e,buttonPopupStore:w.a}))}renderNormalTopbar(){const{store:e,pageVisitStore:t,presenceStore:n}=this.props,{isTablet:i}=this.environment.device,o=this.props.isInvalidPage;return r.createElement("div",{onClick:this.handleTopbarClick,style:this.getStyle(),className:C.Mb},this.renderHamburgerButton(),i&&r.createElement(re.a,null),!o&&this.renderBreadcrumbs(),e.canEdit()&&i&&r.createElement(k.a,{store:e,isMobile:!1,key:e.id}),r.createElement(b.a,null),e.isRestricted()&&r.createElement(se.a,{style:{marginRight:8},onClick:()=>{this.stores.shareButtonPopupStore.setState({open:!0})}}),i&&e.canEdit()&&t&&n&&r.createElement(te.a,{rootStore:e,pageVisitStore:t,presenceStore:n}),this.props.shouldShowMoveTo?this.renderCancelQuickAdd():this.renderRightButtons())}renderHamburgerButton(){const e=O.a.getUnreadMentionsCountForOtherSpaces();return r.createElement(E.a,{mobileFeedback:!0,style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,height:"100%",width:36,marginLeft:4},onClick:()=>{Object(ee.a)(this.environment)?y.setExpand({environment:this.environment,isExpanded:!$.a.get()}):y.open(),o.Tc(this.environment)}},s.a.hamburgerMenu({width:18,height:18}),r.createElement(f.a,{color:f.a.Color.Red,count:e,style:{position:"absolute",top:9,right:1}}))}renderBreadcrumbs(){const{isTablet:e}=this.environment.device;return this.props.shouldShowMoveTo?this.renderMoveTo():r.createElement(d.a,{store:this.props.store,style:this.getBreadcrumbsStyle(),maxAncestorCount:e?2:1,showCurrentPageControls:!1,ancestorMaxWidth:e?160:100,currentPageMaxWidth:e?240:220,isMobile:!0})}renderMoveTo(){var e=this;const{store:t}=this.props,n=t.getParentStore(),{currentSpaceStore:i}=I.default.state,o=n instanceof l.a&&i&&n.id===i.id;if(n){if(o)return r.createElement(E.a,{mobileFeedback:!0,style:de.moveToButtonStyle,onClick:this.handleMoveToClick},r.createElement(ne.FormattedMessage,{defaultMessage:"<mediumcolor>Add to</mediumcolor>{userAvatar}<mediumweight>Private pages</mediumweight>",id:"topbarMobile.addToPrivateSectionButton.label",values:{mediumcolor:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return r.createElement("span",{style:{color:e.theme.mediumTextColor,marginRight:8}},n)},mediumweight:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.createElement("span",{style:{fontWeight:L.a.fontWeight.medium,marginLeft:4}},t)},userAvatar:r.createElement(J.a,{size:22,avatarShouldShowShadow:!0,userValue:Object(K.g)(this.environment)})}}),this.renderChevron());{const e=t instanceof l.a?Object(oe.getSpaceIcon)(this.environment,t):t.getIcon();return r.createElement(E.a,{mobileFeedback:!0,style:de.moveToButtonStyle,onClick:this.handleMoveToClick},r.createElement("span",{style:{color:this.theme.mediumTextColor}},r.createElement(ne.FormattedMessage,{defaultMessage:"Add to",id:"topbarMobile.addToPageOrWorkspaceSectionButton.label",description:"Displayed to the user in front of a page or space, like 'Add to Page', where 'Page' is an existing page."})," "),r.createElement(z.a,{disabled:!0,icon:e,isEmptyPage:n.table===Z.b&&n.isEmptyPage(),title:n instanceof l.a?Object(oe.getSpaceName)(this.environment,n):void 0,size:24,style:{marginLeft:8,marginRight:4}}),r.createElement(q.a,{style:{fontWeight:L.a.fontWeight.semibold},store:n}),this.renderChevron())}}}renderChevron(){return s.a.chevronDown({marginLeft:4,width:10,fill:this.theme.lightTextColor})}renderRightButtons(){const{device:e}=this.environment;if(!this.props.isInvalidPage)return e.isReactNative?r.createElement(r.Fragment,null,this.renderShare(),this.renderShowMore()):r.createElement(r.Fragment,null,this.renderShowMore(),this.renderShare(),this.renderUpdatesButton())}renderCancelQuickAdd(){return r.createElement(E.a,{mobileFeedback:!0,style:{display:"flex",alignItems:"center",height:"100%",paddingLeft:16,paddingRight:16,fontWeight:L.a.fontWeight.medium,color:Q.f.blue},onClick:this.handleCancelQuickAdd},r.createElement(ne.FormattedMessage,{defaultMessage:"Cancel",id:"topbarMobile.cancelQuickAddButton.label"}))}renderShowMore(){return r.createElement(p.a,{store:this.props.store,collectionViewStore:this.props.collectionViewStore,buttonPopupStore:w.a})}renderShare(){const{device:e}=this.environment;return r.createElement(h.a,{popupType:e.isMobile?h.a.PopupType.SlideUp:h.a.PopupType.Popup,style:{width:460},buttonPopupStore:this.stores.shareButtonPopupStore,onClick:this.handleShareClick,renderOrigin:t=>r.createElement(E.a,Object.assign({mobileFeedback:!0,style:de.actionButtonStyle},t),e.isAndroid?s.a.androidShare({width:16,height:16}):s.a.iOSShare({width:26})),render:()=>r.createElement(ae.LazyBlockPermissionsSettings,{buttonPopupStore:this.stores.shareButtonPopupStore,store:this.props.store,onClose:()=>{this.stores.shareButtonPopupStore.setState(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){ce(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.stores.shareButtonPopupStore.state,{open:!1}))}})})}renderUpdatesButton(){return r.createElement(V.a,{format:V.a.Format.TopbarMobile})}getWrapStyle(){return{width:"100%",maxWidth:"100vw",zIndex:i.v}}getStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",maxWidth:"100vw",height:ie.b,marginTop:e.state.paddingTopCSS,paddingLeft:e.getSafePaddingLeftCSS(0),paddingRight:this.props.shouldShowMoveTo?e.getSafePaddingRightCSS(0):e.getSafePaddingRightCSS(7),boxShadow:"0 1px 0 ".concat(this.theme.darkDividerColor),background:this.theme.contentBackground,transition:"box-shadow 300ms",WebkitUserSelect:"none",cursor:"pointer"}}getBreadcrumbsStyle(){const{isTablet:e}=this.environment.device;return{flexGrow:0,marginLeft:2,overflow:"auto",WebkitOverflowScrolling:"touch",marginRight:e?16:8,height:"100%"}}}de.actionButtonStyle={display:"flex",alignItems:"center",height:"100%",paddingLeft:6,paddingRight:6},de.moveToButtonStyle={display:"flex",alignItems:"center",paddingLeft:8,paddingRight:12,fontSize:L.a.fontSize.UIRegular.mobile,lineHeight:L.a.lineHeight.UIRegular.mobile,whiteSpace:"nowrap",minWidth:0};t.default=de},HTFi:function(e,t,n){"use strict";var r=n("LqYT"),i=n("X3py"),o=n("5qTp");t.a=new r.a(()=>{const{phase:e}=i.b.state;return!!o.default.state.open||(e===i.a.hidden||e===i.a.willHide)})},OeJx:function(e,t,n){"use strict";n.r(t);n("ioFf"),n("rGqo");var r=n("q1tI"),i=n("yNyh"),o=n("G4GV"),s=n("wldR"),a=n("mF3+"),l=n("6rsX"),c=n("unoy"),d=n("D8Ld"),h=n("stZG"),m=n("rGsA"),u=n("J9+s");function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class f extends s.a{constructor(){super(...arguments),this.storeTypes={store:o.a},this.handleFocused=()=>{l.e(this.environment),c.f(this.environment),this.stores.store.setState(g({},this.stores.store.state,{focus:!0}))},this.handleBlurred=()=>{this.stores.store.setState(g({},this.stores.store.state,{focus:!1}))},this.handleSearchQueryChange=e=>{this.props.onChange({searchQuery:e.target.value})}}renderComponent(){const{searchQuery:e,intl:t}=this.props,{focus:n}=this.stores.store.state;return r.createElement(d.a,{capture:n},r.createElement(h.a,{capture:!0,render:o=>r.createElement("div",Object.assign({},o),r.createElement(i.b,{style:this.getStyle(),format:i.a.Transparent,value:e,placeholder:t.formatMessage({defaultMessage:"Type to search…",id:"database.mobileSearch.placeholder"}),onChange:this.handleSearchQueryChange,autoComplete:"on",autoCorrect:"on",onFocus:this.handleFocused,onBlur:this.handleBlurred,showClearButton:!0,left:a.a.searchThick(this.getSearchIconStyle())}),r.createElement(m.a,{show:n}))}))}getStyle(){return{boxShadow:this.theme.inputBoxShadow,background:this.theme.inputBackground,flexGrow:0,flexShrink:0,height:32,paddingLeft:8,paddingRight:12,borderRadius:3,fontSize:14,marginBottom:4}}getSearchIconStyle(){return{width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:this.theme.mediumIconColor}}}t.default=Object(u.injectIntl)(f)},QvPY:function(e,t,n){"use strict";n.r(t);n("ioFf"),n("rGqo");var r=n("q1tI"),i=n("wldR"),o=n("QtqF"),s=n("4aFz"),a=n("8fuX"),l=n("UJva"),c=n("OIKt"),d=n("b936"),h=n("zK7c"),m=n("X6Ne"),u=n("i3uR"),p=n("5XPD"),g=n("Na01"),b=n("mF3+"),f=n("gbGO"),S=n("ohKz"),y=n("MeYt"),v=n("ty0h"),k=n("ibYI"),w=n("vJXr"),O=n("2A6Q"),E=n("pqiZ"),C=n("aEEb"),T=n("VoJ/"),P=n("CSYU"),M=n("wlCD"),B=n("QcDD"),I=n("qKs6"),x=n("J9+s"),j=n("r8MX"),F=n("Cycz"),A=n("2ZkR"),R=n("8Gp+"),D=n("rQb/"),W=n("IoOo");class L extends i.a{constructor(){super(...arguments),this.storeTypes={passwordRequestStore:P.a},this.handleClose=()=>{S.a.setState({open:!1})},this.handleStartOfWeekToggle=()=>{1===this.getStartDayOfWeek()?Object(I.e)(this.environment):Object(I.d)(this.environment)}}renderComponent(){const{device:e}=this.environment,{data:t}=j.default.state,n=S.a.state.open,i="on"===A.default.getGroup(this.environment,"user-data-consent"),o=e.isIOS&&F.z(t);return r.createElement(u.a,{popupType:e.isMobile?u.a.PopupType.SlideUp:u.a.PopupType.Popup,buttonPopupStore:S.a,renderOrigin:e=>r.createElement(y.a,Object.assign({mobileFeedback:this.props.isMobile},e),r.createElement(g.a,{left:this.renderIcon(),style:{background:n?this.theme.buttonHoveredBackground:"none"},isMobile:this.props.isMobile,disableMobileBorder:!0},r.createElement(x.FormattedMessage,{defaultMessage:"Notifications & settings",id:"notificationSettingsButton.mobileSidebar.label"}))),render:()=>{let n;if(n=e.isMobile?{menuType:f.b.MenuType.Modal,title:r.createElement(x.FormattedMessage,{defaultMessage:"Notifications & settings",id:"notificationSettingsButton.mobileSidebar.title"}),right:r.createElement(x.FormattedMessage,{defaultMessage:"Done",id:"notificationSettingsButton.rightActionButton.done"}),onClickRight:this.handleClose,whiteBackground:!0}:{menuType:f.b.MenuType.Popup},w.a.state.online){const{passwordRequestStore:e}=this.stores;return r.createElement(f.b,Object.assign({},n),e.state.loading?r.createElement(M.a,{style:{margin:"50% auto"}}):r.createElement(O.a,null,r.createElement(p.a,null),r.createElement(E.a,{size:48,isHidden:!0}),r.createElement(D.a,{divider:"full"},r.createElement(x.FormattedMessage,{id:"notificationSettingsButton.generalSection.title",defaultMessage:"General"})),r.createElement(T.a,{requestStore:e,isEducationPlan:F.y(t)}),this.renderAppearanceSettings(),o&&this.renderSubscriptionSettings(),i&&this.renderUserDataConsentSettings(),r.createElement(E.a,{size:32}),r.createElement(k.a,{onClick:this.handleStartOfWeekToggle,startDayOfWeek:this.getStartDayOfWeek()||0})))}return r.createElement(O.a,null,r.createElement(C.a,{isSmall:!0,style:{textAlign:"center"}},r.createElement(x.FormattedMessage,{defaultMessage:"Please go online to manage settings.",id:"notificationSettingsButton.goOnline.prompt"})))}})}renderUserDataConsentSettings(){return r.createElement(r.Fragment,null,r.createElement(E.a,{size:32}),r.createElement(R.a,null))}renderAppearanceSettings(){return r.createElement(r.Fragment,null,r.createElement(E.a,{size:32}),r.createElement(v.a,null))}renderSubscriptionSettings(){return r.createElement(r.Fragment,null,r.createElement(E.a,{size:32}),r.createElement(W.a,null))}renderIcon(){return b.a.sidebarSettings({fill:this.theme.mediumIconColor,width:16})}getStartDayOfWeek(){const{currentUserSettingsStore:e}=B.default.state;if(e){const t=e.getSettings();if(t)return t.start_day_of_week}}}var U=L,z=n("5ma9");class q extends i.a{renderComponent(){const e=r.createElement(x.FormattedMessage,{defaultMessage:"Upgrade to Pro",id:"upgradeMobileButton.upgradeButton.label"});return r.createElement(y.a,{mobileFeedback:!0,onClick:this.showUpgradeModal(this.environment)},r.createElement(g.a,{left:this.renderIcon(),isMobile:!0,disableMobileBorder:!0},e))}renderIcon(){return b.a.settingsUpgradeFilled({fill:this.theme.mediumIconColor,width:16})}showUpgradeModal(e){return()=>{const{reactNative:t}=e;t&&t.openUpgradeModal(Object(z.a)())}}}var N=q,V=n("g4rC"),Q=n("3wHm");class G extends i.a{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:V.a},this.handleClose=()=>{this.stores.buttonPopupStore.setState({open:!1})}}renderComponent(){if(!F.Q(this.environment))return;const{store:e}=this.props,{buttonPopupStore:t}=this.stores;return r.createElement(u.a,{buttonPopupStore:t,popupType:u.a.PopupType.SlideUp,renderOrigin:e=>r.createElement(y.a,Object.assign({mobileFeedback:!0},e),r.createElement(g.a,{left:this.renderIcon(),isMobile:!0,disableMobileBorder:!0},r.createElement(x.FormattedMessage,{defaultMessage:"Members",id:"memberSettingsButton.mobileSidebar.label"}))),render:()=>{if(w.a.state.online){const t={menuType:f.b.MenuType.Modal,title:r.createElement(x.FormattedMessage,{defaultMessage:"Members",id:"memberSettingsButton.mobileMemberSettings.title"}),right:r.createElement(x.FormattedMessage,{defaultMessage:"Done",id:"memberSettingsButton.rightActionButton.done"}),onClickRight:this.handleClose};return r.createElement(f.b,Object.assign({},t),r.createElement(Q.a,{store:e,isMobile:!0}))}this.renderOffline()}})}renderIcon(){return b.a.teamSize({fill:this.theme.mediumIconColor,width:16})}renderOffline(){return r.createElement(O.a,null,r.createElement(C.a,{isSmall:!0,style:{textAlign:"center"}},r.createElement(x.FormattedMessage,{defaultMessage:"Please go online to manage members.",id:"memberSettingsButton.goOnline.prompt"})))}}var H=G,_=n("FcJC"),X=n("VyA+"),Z=(n("a1Th"),n("yjqD")),Y=n("6rsX"),J=n("UcZb"),K=n("0zNc"),$=n("84+D"),ee=n("7M94"),te=n("Rtjx");class ne extends i.a{constructor(){super(...arguments),this.handleTouchStart=e=>{const t={x:e.touches[0].clientX,y:e.touches[0].clientY};J.c.state?t.x>Object(te.c)(this.environment)?$.a.setState({touching:!0,swiping:!1,start:t}):this.handleReset():Object(te.g)(this.environment)&&t.x<100?$.a.setState({touching:!0,swiping:!1,start:t}):this.handleReset()},this.handleTouchMove=e=>{if(K.a.state.isDragging)return void this.handleReset();const t=$.a.state;if(!t.touching)return;const n={x:e.touches[0].clientX,y:e.touches[0].clientY};if(t.swiping)$.a.setState({touching:!0,swiping:!0,start:t.start,speed:J.c.state?t.end.x-n.x:n.x-t.end.x,end:n});else{if(Math.abs(n.y-t.start.y)>=25)return void this.handleReset();(!J.c.state&&n.x-t.start.x>25||J.c.state&&t.start.x-n.x>25)&&$.a.setState({touching:!0,swiping:!0,start:t.start,speed:0,end:n})}this.updateTransform()},this.handleTouchEnd=async()=>{const{ThemeStore:e}=this.environment,t=$.a.state;if(!t.swiping)return;const n=Object(te.c)(this.environment),r=document.querySelector(Object(te.g)(this.environment)?".".concat(ee.xb):".".concat(ee.y)),i=document.querySelector(".".concat(ee.y)),o=Math.abs(t.speed)>=8,s=o?"ease-out":"ease-in-out",a="dark"===e.state.mode?", 1px 0 0 ".concat(this.theme.shadowColor.alpha(2*this.theme.shadowOpacity).css()):"",l="\n\t\t\t".concat(this.theme.mediumBoxShadow,"\n\t\t\t").concat(a,"\n\t\t");if(J.c.state){const e=t.start.x-t.end.x;if(e+25*t.speed>n/2){let t=o?(n-e)/n*200:200;t=Math.max(t,1),r.style.transition="transform ".concat(t,"ms ").concat(s),r.style.transform="translateZ(0)translateX(0px)",Object(te.g)(this.environment)&&(r.style.boxShadow=l,i.style.transition="filter ".concat(t,"ms ").concat(s),i.style.filter="brightness(1)"),await ie(r),_.close(),this.handleReset()}else r.style.transition="transform ".concat(200,"ms ").concat(s),r.style.transform="translateZ(0)translateX(".concat(n,"px)"),Object(te.g)(this.environment)&&(r.style.boxShadow=l,i.style.transition="filter ".concat(200,"ms ").concat(s),i.style.filter="brightness(0.7)"),await ie(r),this.handleReset()}else{const e=t.end.x-t.start.x;if(e+25*t.speed>n/2){let t=o?(n-e)/n*200:200;t=Math.max(t,1),r.style.transition="transform ".concat(t,"ms ").concat(s),r.style.transform="translateZ(0)translateX(".concat(n,"px)"),Object(te.g)(this.environment)&&(r.style.boxShadow=l,i.style.transition="filter ".concat(t,"ms ").concat(s),i.style.filter="brightness(0.7)"),await ie(r),_.open(),this.handleReset()}else r.style.transition="transform ".concat(200,"ms ").concat(s),r.style.transform="translateZ(0)translateX(0px)",Object(te.g)(this.environment)&&(r.style.boxShadow=l,i.style.transition="filter ".concat(200,"ms ").concat(s),i.style.filter="brightness(1)"),await ie(r),this.handleReset()}},this.handleSidebarToggle=()=>{this.updateTransform()},this.updateTransform=async()=>{const e=document.querySelector(Object(te.g)(this.environment)?".".concat(ee.xb):".".concat(ee.y)),t=document.querySelector(".".concat(ee.y)),n=Object(te.c)(this.environment),r=$.a.state;if(r.swiping)if(J.c.state){const i=n-(r.start.x-r.end.x)+25,o=Math.min(Math.max(0,i),n);if(e.style.transition="none",e.style.transform="translateZ(0)translateX(".concat(o,"px)"),Object(te.g)(this.environment)){e.style.boxShadow=this.theme.mediumBoxShadow,t.style.transition="none";const r=(1-.3*o/n).toString();t.style.filter="brightness(".concat(r,")")}}else{const i=r.end.x-r.start.x-25,o=Math.min(Math.max(0,i),n);if(e.style.transition="none",e.style.transform="translateZ(0)translateX(".concat(o,"px)"),Object(te.g)(this.environment)){e.style.boxShadow=this.theme.mediumBoxShadow,t.style.transition="none";const r=(1-.3*o/n).toString();t.style.filter="brightness(".concat(r,")")}}else J.c.state?(e.style.transition="transform 200ms",e.style.transform="translateZ(0)translateX(".concat(n,"px)"),Object(te.g)(this.environment)&&(e.style.transform="translateZ(0)translateX(calc(".concat(n,"px - 1px))"),e.style.boxShadow=this.theme.mediumBoxShadow,t.style.transition="filter 200ms",t.style.filter="brightness(0.7)"),Y.e(this.environment)):(e.style.transition="transform 200ms",e.style.transform="translateZ(0)translateX(0)",Object(te.g)(this.environment)&&(e.style.boxShadow="none",t.style.transition="filter 200ms",t.style.filter="brightness(1)"))}}didMount(){const{device:e}=this.environment;e.isMobile&&(window.addEventListener("touchstart",this.handleTouchStart),window.addEventListener("touchmove",this.handleTouchMove),window.addEventListener("touchend",this.handleTouchEnd),J.c.addListener(this.handleSidebarToggle))}willUnmount(){const{device:e}=this.environment;e.isMobile&&(window.removeEventListener("touchstart",this.handleTouchStart),window.removeEventListener("touchmove",this.handleTouchMove),window.removeEventListener("touchend",this.handleTouchEnd),J.c.removeListener(this.handleSidebarToggle))}handleReset(){$.a.reset(),this.updateTransform()}}var re=ne;async function ie(e){const t=Z.c();e.addEventListener("transitionend",t.resolve),e.addEventListener("webkitTransitionEnd",t.resolve),await t.promise,e.removeEventListener("transitionend",t.resolve),e.removeEventListener("webkitTransitionEnd",t.resolve)}var oe=n("GRWW"),se=n("p0Uu"),ae=n("zmp8"),le=n("HTHG"),ce=n("NOLh"),de=n("wS9/"),he=n("ij+4"),me=n("AUNf"),ue=n("jzfh");function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){be(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function be(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class fe extends i.a{constructor(){super(...arguments),this.sidebarState=this.createComputedStore(()=>Object(le.i)(this.environment)),this.storeTypes={scrollerStore:oe.a},this.handleScrollerMount=e=>{se.a.SidebarMobileScroller=e},this.handleCloseSidebar=()=>{_.close()},this.handleClickFind=()=>s.c({environment:this.environment,analyticsFrom:"sidebar-mobile"}),this.handleOrientationChange=()=>{_.close()},this.isScrolledToTop=this.createComputedStore(()=>0===this.stores.scrollerStore.state.scrollTop),this.currentOfflinePages=this.createComputedStore(()=>me.default.getCurrentOfflinePagesStore())}willMount(){window.addEventListener("resize",this.handleOrientationChange)}willUnmount(){window.removeEventListener("resize",this.handleOrientationChange)}renderComponent(){const e=te.a(this.environment);return e?r.createElement(ce.a,{render:()=>r.createElement("div",{className:ee.xb,style:this.getWrapStyle()},!e&&r.createElement(re,null),this.renderSidebar()),isVisible:!0,animationStyle:{width:e?te.b(this.environment):"100vw"}}):r.createElement("div",{className:ee.xb,style:ge({},this.getWrapStyle(),{width:"100vw"})},!e&&r.createElement(re,null),this.renderSidebar())}renderSidebar(){return r.createElement(X.a,{capture:!te.a(this.environment)&&J.c.get(),onBackButton:this.handleCloseSidebar},r.createElement("div",{style:this.getStyle()},this.renderTopbar(),this.renderOutliner()))}renderTopbar(){const{device:e}=this.environment,t=e.isReactNative&&e.isTablet&&te.a(this.environment);return r.createElement("div",{style:this.getTopbarStyle()},r.createElement(he.b,{shouldShowUnexpandButton:t,format:he.a.Mobile}),!e.isReactNative&&r.createElement(y.a,{onClick:this.handleClickFind,mobileFeedback:!0,style:fe.actionButtonStyle},b.a.mobileBottomBarSearch({width:26})))}renderOutliner(){const{currentSpaceStore:e,currentSpaceViewStore:t,currentUserRootStore:n,currentUserStore:i,currentUserSettingsStore:s,currentBlockStore:u}=B.default.state,p=this.sidebarState.state;if(!(p&&u&&t&&n&&e&&i&&s))return;const g=e.canEdit(),b=this.environment.device.isIOS&&"personal_free"===Object(F.j)(this.environment)&&j.default.state.data&&"unsubscribed_admin"===j.default.state.data.type&&j.default.state.data.revenueCatEnabled;return r.createElement(h.a,{store:e,disableEditNearestBlock:!0,render:n=>r.createElement(a.b,{store:this.stores.scrollerStore,ref:this.handleScrollerMount,style:fe.outlinerStyle,disableScroll:m.e(this.environment),type:a.b.OverflowType.Y},p.showOfflineSection&&r.createElement(c.a,{isMobile:!0,type:"offline",spaceStore:e,spaceViewStore:t,showAddPageButton:!1,renderSidebar:()=>r.createElement(o.a,{isMobile:!0,type:"offline",isTopLevel:!0,spaceStore:e,spaceViewStore:t,childStores:this.currentOfflinePages.state,showAddPageButton:!1,onNavigate:this.handleCloseSidebar,onCreatePage:this.handleCloseSidebar,disabled:!g})}),p.showBookmarksSection&&r.createElement(c.a,{isMobile:!0,type:"bookmarks",spaceStore:e,spaceViewStore:t,showAddPageButton:!1,renderSidebar:()=>r.createElement(o.a,{isMobile:!0,type:"bookmarks",isTopLevel:!0,spaceStore:e,spaceViewStore:t,parentStore:t.getBookmarkedPagesStore(),childStores:t.getBookmarkedPages(),showAddPageButton:!1,onNavigate:this.handleCloseSidebar,onCreatePage:this.handleCloseSidebar,disabled:!g})}),p.showWorkspaceSection&&r.createElement(c.a,{isMobile:!0,type:"workspace",spaceStore:e,spaceViewStore:t,showAddPageButton:!1,renderSidebar:()=>r.createElement(o.a,{isMobile:!0,type:"workspace",isTopLevel:!0,spaceStore:e,spaceViewStore:t,parentStore:e.getPagesStore(),childStores:t.getWorkspacePages(),addPageTitle:r.createElement(x.FormattedMessage,{defaultMessage:"Add a page",id:"sidebarMobile.addPageToWorkspace.title"}),onNavigate:this.handleCloseSidebar,onCreatePage:this.handleCloseSidebar,showAddPageButton:!0,disabled:!g})}),p.showSharedSection&&r.createElement(c.a,{isMobile:!0,type:"shared",spaceStore:e,spaceViewStore:t,showAddPageButton:!1,renderSidebar:n=>r.createElement(r.Fragment,null,r.createElement(o.a,{isMobile:!0,type:"shared",isTopLevel:!0,spaceStore:e,spaceViewStore:t,parentStore:t.getSharedPagesStore(),childStores:p.visibleSharedPagesStores,showAddPageButton:!1,onNavigate:this.handleCloseSidebar,onCreatePage:this.handleCloseSidebar,disabled:!g}),this.isEnhancedSidebarEnabled&&p.showSharedOverflowButton&&r.createElement(ue.a,{originRef:n,isMobile:!0,type:"shared",spaceStore:e,spaceViewStore:t,userSettingsStore:s,allSharedPages:p.allSharedPagesStores,visiblePageIds:p.visibleSharedPagesStores.map(e=>{let{id:t}=e;return t})}))}),p.showPrivateSection&&!p.showOnlyPrivateSection&&r.createElement(c.a,{isMobile:!0,type:"private",spaceStore:e,spaceViewStore:t,showAddPageButton:!1,renderSidebar:()=>r.createElement(o.a,{isMobile:!0,type:"private",isTopLevel:!0,spaceStore:e,spaceViewStore:t,parentStore:e.getPagesStore(),childStores:t.getPrivatePages(),addPageTitle:r.createElement(x.FormattedMessage,{defaultMessage:"Add a page",id:"sidebarMobile.addAPrivatePage.title"}),showAddPageButton:!0,onNavigate:this.handleCloseSidebar,onCreatePage:this.handleCloseSidebar,disabled:!g})}),p.showOnlyPrivateSection&&r.createElement(o.a,{isMobile:!0,type:"private",isTopLevel:!0,spaceStore:e,spaceViewStore:t,parentStore:e.getPagesStore(),childStores:t.getPrivatePages(),addPageTitle:r.createElement(x.FormattedMessage,{defaultMessage:"Add a page",id:"sidebarMobile.addAPageToOnlyPrivateSection.title"}),showAddPageButton:!0,onNavigate:this.handleCloseSidebar,onCreatePage:this.handleCloseSidebar,disabled:!g}),p.showOnlyPrivateSection&&r.createElement("div",{style:{height:20}}),r.createElement(H,{store:e}),r.createElement(U,{isMobile:!0}),e.canEdit()&&r.createElement(d.a,{store:u,isMobile:!0}),b&&r.createElement(N,null),r.createElement(l.a,{isMobile:!0}),r.createElement("div",{style:{height:128}}))})}get isEnhancedSidebarEnabled(){return"on"===A.default.getGroup(this.environment,"sidebar-enhancements")}getWrapStyle(){return te.a(this.environment)?{display:"block",height:"100vh",position:"relative",zIndex:3}:te.g(this.environment)?{display:"block",height:"100vh",position:"fixed",top:0,right:"100%",zIndex:3}:{display:"block",height:"100vh",position:"fixed",top:0,left:0}}getStyle(){return ge({display:"flex",flexDirection:"column",width:te.c(this.environment),height:"100%",background:te.g(this.environment)?this.theme.mobileSidebarAndroidBackground:this.theme.mobileSidebarIOSBackground,willChange:"transform",color:this.theme.mediumTextColor},te.g(this.environment)&&{marginLeft:"auto"},{},te.a(this.environment)&&{position:"absolute",right:0},{cursor:"pointer"})}getTopbarStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",alignItems:"center",justifyContent:"space-between",flex:"none",height:de.b,marginTop:e.state.paddingTopCSS,paddingLeft:12,boxShadow:te.g(this.environment)&&!te.a(this.environment)&&J.c.state?this.isScrolledToTop.state?this.theme.topbarAndroidShadowCollapsed:this.theme.topbarAndroidShadow:"0 1px 0 ".concat(this.theme.darkDividerColor),background:te.g(this.environment)?this.theme.androidSidebarBackground:ae.f.transparent,transition:"box-shadow 300ms",width:"100%",zIndex:1}}}fe.outlinerStyle={flexGrow:1,paddingTop:12,userSelect:"none",WebkitUserSelect:"none"},fe.actionButtonStyle={display:"flex",alignItems:"center",justifyContent:"center",flex:"none",height:"100%",width:44,paddingRight:6};t.default=fe},W8UH:function(e,t,n){"use strict";n.r(t);n("ioFf"),n("rGqo");var r=n("q1tI"),i=n("mKX5"),o=n("wldR"),s=n("mF3+"),a=n("LEzx");class l extends a.a{getInitialState(){return{}}}var c=l,d=n("Sb6f"),h=n("/YYm"),m=n("Oy36"),u=n("OxuQ"),p=n("IdIf"),g=n("0lqH"),b=n("D2XV"),f=n("7TLZ"),S=n("prF1"),y=n("SR/M"),v=n("vl8/");function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class E extends o.a{constructor(){super(...arguments),this.renderProperty=e=>{const{schema:t,store:n,blockPropertyValueOverlayStore:i}=this.props;if(t[e])return r.createElement(g.b,{key:e,store:n,property:e,schema:t,disabled:!0,locked:!1,format:g.b.Format.Calendar,tableWrap:!1,blockPropertyValueOverlayStore:i})}}renderComponent(){const{time:e,store:t}=this.props,n=t.hasIcon()||!t.isEmptyPage(),i=Object(h.a)({store:t,fullyQualified:!1}),o=f.h(t);return r.createElement(S.a,{href:i},r.createElement(y.a,{focused:!1,title:r.createElement(r.Fragment,null,e&&r.createElement("div",{style:{display:"flex",color:this.theme.mediumTextColor,fontSize:14,marginTop:8,marginBottom:6}},e),r.createElement("div",{style:w({display:"flex",alignItems:"center"},e&&{marginBottom:8})},n&&r.createElement(m.a,{disabled:!0,icon:t.getIcon(),isEmptyPage:t.isEmptyPage(),size:24,style:{flexShrink:0,marginRight:8}}),r.createElement(u.a,{store:t,style:{fontWeight:d.a.fontWeight.semibold}}),o>0&&r.createElement("div",{style:{display:"flex",alignItems:"center",color:this.theme.regularDividerColor,fontSize:12,marginLeft:4,flexShrink:0}},s.a.speechBubble({width:12,height:12,marginRight:4,fill:this.theme.mediumIconColor}),o))),caption:this.renderProperties()}))}renderProperties(){const{format:e,schema:t,store:n}=this.props,i=(e.calendar_properties?e.calendar_properties.filter(e=>e.visible).map(e=>e.property):[]).filter(e=>p.e({blockValue:n.getValue(),property:e,schema:t,getRecordValue:n.getRecordValue,userTimeZone:b.m,intl:v.default.getIntl()}));if(i.length>0)return r.createElement("div",{style:{marginTop:8}},i.map(this.renderProperty))}}var C=E,T=n("wpmu"),P=n("Pl3d"),M=n("bkwR"),B=n("CSYU"),I=n("1QGs"),x=n("MBf9"),j=n("gbGO"),F=n("2Y+N"),A=n("nObc"),R=n("VVDu"),D=n("zTdN"),W=n("lCCU"),L=n("H4VD"),U=n("HTHG"),z=n("O+wX"),q=n("zgcg"),N=n("J9+s"),V=n("nPEg"),Q=n("HRSx");function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class X extends o.a{constructor(){var e;super(...arguments),e=this,this.storeTypes={store:c,requestStore:B.a},this.renderResults=function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const{requestStore:i}=e.stores,{disabled:o}=e.props,a=e.getCurrentStartOfDay(),l=a.clone().endOf("day");return r.createElement(j.b,{menuType:j.b.MenuType.Modal,title:r.createElement("div",{style:X.headerStyle},r.createElement(W.a,{onClick:e.handleLeftClick,icon:s.a.chevronLeft,style:{marginRight:8,marginTop:2},mobileFeedback:!0}),r.createElement("div",null,a.format("MMMM Do")),r.createElement(W.a,{onClick:e.handleRightClick,icon:s.a.chevronRight,style:{marginLeft:8,marginTop:2},mobileFeedback:!0})),right:r.createElement(V.DoneMenuText,null),onClickRight:e.props.onDismiss},i.state.loading&&r.createElement(F.a,null,r.createElement(R.a,null)),!i.state.loading&&0===n.length&&r.createElement(F.a,null,r.createElement(D.a,{title:r.createElement(N.FormattedMessage,{defaultMessage:"No items",id:"mobileCalendarDayMenu.noResults.message"})})),!i.state.loading&&n.length>0&&r.createElement(F.a,null,n.map(t=>e.renderItem(t,a,l))),!o&&r.createElement(F.a,{topBorder:!0},r.createElement(A.a,{focused:!1,onClick:e.handleAddItemClick,title:r.createElement(N.FormattedMessage,{defaultMessage:"New item",id:"mobileCalendarDayMenu.newItemButton.label"})})))},this.handleLeftClick=()=>{const e=this.getCurrentStartOfDay();this.stores.store.setState(H({},this.stores.store.state,{currentStartOfDay:e.clone().add(-1,"day").valueOf()}))},this.handleRightClick=()=>{const e=this.getCurrentStartOfDay();this.stores.store.setState(H({},this.stores.store.state,{currentStartOfDay:e.clone().add(1,"day").valueOf()}))},this.handleAddItemClick=()=>{const{collectionViewLocalStore:e,collectionStore:t,calendarBy:n}=this.props,r=this.getCurrentStartOfDay(),i=x.createAndCommit(this.environment,i=>I.e({environment:this.environment,collectionStore:t,collectionViewLocalStore:e,calendarBy:n,startOfDay:r.valueOf(),transaction:i})),o=Object(h.a)({store:i});this.navigate(o)},this.performRequest=async e=>{const{collectionStore:t,collectionViewStore:n,query:r}=this.props,o=Object(i.a)(e).endOf("day").valueOf(),s=await M.queryCollection(this.environment,{collectionId:t.id,collectionViewId:n.id,query:r,loader:{type:"calendar",dateRangeStart:e,dateRangeEnd:o,searchQuery:void 0,scale:"day",userTimeZone:b.m,startDayOfWeek:U.q.state}});if("failed"===s.type)throw s.error;return"calendar"===s.data.result.type?s.data.result.groups[0].items:[]}}navigate(e){this.context.overrideLinkClick?this.context.overrideLinkClick(e):L.navigate({environment:this.environment,url:e})}renderComponent(){const{requestStore:e}=this.stores;return r.createElement(P.a,{requestStore:e,request:this.getCurrentStartOfDay().valueOf(),performRequest:this.performRequest,render:this.renderResults})}renderItem(e,t,n){const{collectionStore:i,disabled:o,blockPropertyValueOverlayStore:s}=this.props,a=T.a.createChildStore(i,{table:Q.b,id:e.id});return r.createElement(C,{key:e.id,store:a,time:e.includeTime?this.renderTime(e,t,n):void 0,disabled:o,format:this.props.format,schema:this.props.schema,blockPropertyValueOverlayStore:s})}renderTime(e,t,n){const{schema:r,calendarBy:o,intl:s}=this.props,a=r[o];if(!a||"date"!==a.type)return;const l=a.date_format||b.v,c=a.time_format||b.x,d=Object(i.a)(e.start),h=e.end?Object(i.a)(e.end):void 0,m=Boolean(!d.isBetween(t,n)&&h&&!h.isBetween(t,n));if(e.end){const t=b.s(e.start,e.end,e.timeZone);return m?Object(z.a)({value:t,date_format:l,time_format:c,userTimeZone:e.timeZone,allowRelativeDates:!0,intl:s}):Object(z.d)({start_time:t.start_time,end_time:t.end_time,time_format:c,humanReadable:!0,intl:s})}return Object(z.c)({start_time:b.r(e.start,e.timeZone).start_time,time_format:c,humanReadable:!0,intl:s})}getCurrentStartOfDay(){const{currentStartOfDay:e}=this.stores.store.state;return e?Object(i.a)(e):Object(i.a)(this.props.initialStartOfDay)}}X.contextTypes=q.a,X.headerStyle={display:"flex",alignItems:"center",height:"100%"};t.default=Object(N.injectIntl)(X)},ZKzj:function(e,t,n){"use strict";n.r(t);n("ioFf"),n("rGqo");var r=n("q1tI"),i=n("LvDl"),o=n("mF3+"),s=n("gRnv"),a=n("l4I2"),l=n("CaJT"),c=n("q2qQ"),d=n("6rsX"),h=n("y6Dp"),m=n("Sb6f"),u=n("BJyN"),p=n("LEzx");class g extends p.a{getInitialState(){return{isOpen:!1,isInsertOpen:!1,isTurnIntoOpen:!1,isColorOpen:!1,isTemplatesOpen:!1}}}var b=g,f=n("VOS9"),S=n("gbGO"),y=n("wldR"),v=n("9hmv"),k=n("q8I6"),w=n("y4kc"),O=n("2HDO"),E=n("F9et"),C=n("p+Y9"),T=n("MBf9"),P=n("dsG5"),M=n("HTHG"),B=n("sjR4");var I=n("unoy"),x=n("ikHm"),j=n("hi+p"),F=n("wXH4"),A=n("RI9y"),R=n("ALSZ"),D=n("Ajfl"),W=n("DNgp"),L=n("43ch"),U=n("Iece"),z=n("EmAo"),q=n("5qTp"),N=n("WaiN"),V=n("MeYt"),Q=n("typy"),G=n("6nbh"),H=n("wiBh"),_=n("XfKI"),X=n("wllP"),Z=n("J9+s"),Y=n("QcDD"),J=n("RQ1t"),K=n("WgIs"),$=n("rro+"),ee=n("ui+/"),te=n("bVDK"),ne=n("30UQ"),re=n("nM47"),ie=n("2Y+N"),oe=n("yioD"),se=n("nPEg"),ae=n("xPzf"),le=n("VpIZ"),ce=n("HTFi"),de=n("tCjx"),he=n("1G+a");function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){pe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ge extends y.a{constructor(){super(...arguments),this.storeTypes={store:b,ignoreSelectionAreaStore:G.a,templatePickerMenuListStore:J.a},this.renderMobileTemplatePreviewItem=e=>({key:e.name,render:t=>r.createElement(te.a,Object.assign({key:e.name,title:e.name,type:"page_template",format:"phone-modal",emoji:e.emoji,locked:!1},t)),action:()=>{ne.i({environment:this.environment,item:e,createNewPage:!1,isPrivate:!1})}}),this.renderPageTemplatePickerItem=e=>{const t=this.props.currentBlockStore;return{key:e.name,render:t=>r.createElement(te.a,Object.assign({key:e.name,format:"phone-modal",title:e.name,type:e.type,icon:e.icon,locked:!1},t)),action:n=>{t&&Object(re.k)(this.environment)&&(h.de(this.environment,{name:e.name,is_keyboard:"keydown"===n.event.type}),e.onClick(this.environment,t))}}},this.handleScrollerRef=e=>{e&&(this.scrollerDiv=e)},this.handleCloseColorPopup=()=>{this.stores.store.setState(ue({},this.stores.store.state,{isColorOpen:!1}))},this.handleCloseInsertPopup=()=>{this.stores.store.setState(ue({},this.stores.store.state,{isInsertOpen:!1}))},this.handleCloseTurnIntoPopup=()=>{this.stores.store.setState(ue({},this.stores.store.state,{isTurnIntoOpen:!1}))},this.handleCloseTemplatesPopup=()=>{this.stores.store.setState(ue({},this.stores.store.state,{isTemplatesOpen:!1}))},this.handleUnindent=e=>{if("editing"!==W.default.state.mode)return;const t=W.default.state.store,n=Object(X.c)(t);n&&(T.createAndCommit(this.environment,e=>{D.t({environment:this.environment,store:t,closestSelectable:n,shiftKey:!0,transaction:e})}),this.trackItemTap("unindent"))},this.handleIndent=e=>{if("editing"!==W.default.state.mode)return;const t=W.default.state.store,n=Object(X.c)(t);n&&(T.createAndCommit(this.environment,e=>{D.t({environment:this.environment,store:t,closestSelectable:n,shiftKey:!1,transaction:e})}),this.trackItemTap("indent"))},this.handleMoveUp=async e=>{if("editing"!==W.default.state.mode)return;const t=W.default.state.store,n=Object(X.c)(t);n&&(T.createAndCommit(this.environment,e=>{D.q({environment:this.environment,store:t,closestSelectable:n,transaction:e})}),this.trackItemTap("move-up"))},this.handleMoveDown=e=>{if("editing"!==W.default.state.mode)return;const t=W.default.state.store,n=Object(X.c)(t);n&&(T.createAndCommit(this.environment,e=>{D.p({environment:this.environment,store:t,closestSelectable:n,transaction:e})}),this.trackItemTap("move-down"))},this.handleUndo=()=>{l.f(this.environment),this.trackItemTap("undo")},this.handleRedo=()=>{l.e(this.environment),this.trackItemTap("redo")},this.handleDismissKeyboard=e=>{d.e(this.environment),this.handleCloseInsertPopup(),this.trackItemTap("hide_keyboard"),I.e()},this.handleInsert=e=>{this.stores.store.setState(ue({},this.stores.store.state,{isInsertOpen:!0})),this.trackItemTap("insert")},this.handleTakePicture=e=>{!async function(e){const t=await C.b({multiple:!0,accept:e.device.isIOS?"image/*, video/*":"image/*"}),n=B.default.getCurrentRecordCacheStore(),r=M.b(e);0!==t.length&&n&&T.createAndCommit(e,i=>{const o=P.a({environment:e,files:t,inMemoryRecordCacheStore:n,pageWidth:r,transaction:i});c.k({environment:e,blocks:o,selection:B.default.state.stores,transaction:i}),d.e(e)})}(this.environment),this.trackItemTap("take_picture")},this.handleMention=e=>{R.e(this.environment,{page:!0,createPage:!0,user:!0,bot:!0,date:!0,reminder:!0}),this.trackItemTap("mention")},this.handleComment=e=>{const t=B.default.state.stores[0];t&&(s.d({environment:this.environment,blockStore:t}),this.trackItemTap("discuss"))},this.handleDelete=async e=>{const t=B.default.state.stores[0],n=W.default.state;if(t&&"editing"===n.mode){const e=n.store,r=Object(H.g)(e)||Object(H.h)(e);if(T.createAndCommit(this.environment,e=>{c.n({store:t,transaction:e})}),r){const e=Object(X.c)(r);d.f({environment:this.environment,store:e}),d.g(this.environment)}else d.e(this.environment);this.trackItemTap("remove")}},this.handleActionsScroll=()=>{h.d(this.environment)},this.handleActionsScrollDebounced=i.debounce(this.handleActionsScroll,500),this.handleMoreClick=e=>{d.q({environment:this.environment,stores:B.default.state.stores}),j.c({environment:this.environment,stores:B.default.state.stores,actions:u.c,left:e.clientX,top:e.clientY,showInput:!1,analyticsFrom:"mobile_more_menu"})},this.listenForPositionChanges=this.createComputedStore(()=>{const e=W.default.state;return"editing"===e.mode?{scrollTop:U.a.state.scrollTop,editing:!0,store:e.store.id,selection:e.selection.endIndex}:{scrollTop:U.a.state.scrollTop,editing:!1}}),this.shouldShow=this.createComputedStore(()=>{const{device:e}=this.environment;if(!e.isMobile)return!1;if(q.default.state.open)return!1;if(z.a.state.isOpen)return!1;if(!e.isReactNative&&N.a.state.open)return!1;if(W.default.isEditingComment())return!1;if(this.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState&&"editing"===this.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState.mode)return!0;if("editing"!==W.default.state.mode)return!1;const t=L.a.findEditableWithStore(W.default.state.store);return(!t||!t.props.disableMobileActionBar)&&!!Object(_.B)()}),this.shouldShowTextActions=this.createComputedStore(()=>{const e=W.default.state;if("editing"===e.mode){const t=e.selection;if(t)return t.startIndex!==t.endIndex}const t=this.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState;if(t&&"editing"===t.mode){const e=t.selection;if(e)return e.startIndex!==e.endIndex}return!1}),this.shouldShowBlockActions=this.createComputedStore(()=>!this.shouldShowTextActions.state),this.canTriggerBlockActions=this.createComputedStore(()=>{if(!this.shouldShowBlockActions.state)return!1;const e=oe.a.getMode(this.environment,this.props.currentBlockStore);if(e&&"edit"!==e)return!1;const{stores:t}=B.default.state;return t.length>0&&t[0].canEdit()&&!t[0].isNavigableBlock()}),this.canTriggerTextActions=this.createComputedStore(()=>{const e=oe.a.getMode(this.environment,this.props.currentBlockStore);return(!e||"edit"===e)&&this.props.currentBlockStore.canEdit()})}willMountOrUpdate(){const{device:e}=this.environment;if(e.isMobileBrowser){const e=this.shouldShow.state,t=this.stores.store.state.isOpen;e?t?void 0!==this.currentlyShownTimer&&(window.clearTimeout(this.currentlyShownTimer),this.currentlyShownTimer=void 0):(this.stores.store.setState(ue({},this.stores.store.state,{isOpen:!0})),this.scrollerDiv&&(this.scrollerDiv.scrollLeft=0)):t&&void 0===this.currentlyShownTimer&&(this.currentlyShownTimer=window.setTimeout(()=>{this.currentlyShownTimer=void 0,this.stores.store.setState(ue({},this.stores.store.state,{isOpen:!1}))},200))}else this.scrollerDiv&&(this.scrollerDiv.scrollLeft=0)}renderComponent(){const{device:e,WindowSizeStore:t}=this.environment,n=this.isOpen();return r.createElement(r.Fragment,null,r.createElement(E.a,{capture:!0,render:e=>r.createElement("div",Object.assign({},e,{style:{position:"relative",width:"100%",height:0,zIndex:x.j}}),this.renderActionBar(),this.renderInsertPopup(),this.renderTurnIntoPopup(),this.renderColorPopup(),this.renderTemplatesPopup())}),!n&&e.isIPhoneX&&e.isNative&&r.createElement("div",{style:{position:"absolute",bottom:0,background:"transparent",height:t.state.paddingBottomCSS,width:"100%",pointerEvents:"none",WebkitUserSelect:"none"}}))}renderActionBar(){const{device:e,WindowSizeStore:t}=this.environment,n=this.isOpen(),i=e.isMobile&&ce.a.state;if(this.props.position===he.a.Bottom)return r.createElement("div",{style:{position:"absolute",bottom:i?t.getSafePaddingBottomCSS(de.default.height):0,left:0,height:ge.height,width:"100%",pointerEvents:n?"auto":"none",opacity:n?1:0,transform:n?"translateY(0)":"translateY(".concat(ge.height,"px)"),transition:"opacity 120ms ease-out, transform 120ms ease-out"}},this.renderActionButtons());{const e=this.stores.ignoreSelectionAreaStore.state.savedTextSelectionRect||A.getSelectionRect();if(!e)return;const t=document.body.getBoundingClientRect(),i=ue({},e,{left:10,top:e.top+10-t.top});this.listenForPositionChanges.state;const{device:o}=this.environment;return r.createElement(F.c,{popupType:o.isReactNative?F.c.PopupType.SlideUp:F.c.PopupType.Popup,open:n,preventBlockRenderQueueOnEnter:!0,placementToOrigin:F.c.Placement.Bottom,alignmentToOrigin:F.c.Alignment.Start,originRect:i,disableMouseCapture:!0,keepFocus:!0,render:()=>r.createElement("div",{style:{height:ge.height,width:"calc(80wv)",borderRadius:3,overflow:"hidden"}},this.renderActionButtons())})}}renderActionButtons(){const e=this.shouldShowTextActions.state,t=this.shouldShowBlockActions.state,n=this.shouldShowTemplatesButton();return r.createElement("div",{style:this.getActionButtonStyles()},n&&this.renderTemplatesButton(),!n&&t&&this.renderBlockActions(),!n&&e&&this.renderTextActions(),r.createElement(V.a,{mobileFeedback:!0,disabledFeedback:!0,style:ue({},this.getItemStyle(),{borderLeft:this.getItemBorder(),borderRight:"none"}),onClick:this.handleDismissKeyboard},ge.keyboardIcon))}renderBlockActions(){const e=this.canTriggerBlockActions.state;let t=!1,n=!1;const i=this.props.currentBlockStore.getValue();i&&(Object(le.A)(i)||(t=!0),Object(le.B)(i)||(n=!0));const{device:o}=this.environment;return r.createElement("div",{ref:this.handleScrollerRef,style:this.getActionMenuStyle(),onScroll:this.handleActionsScrollDebounced},r.createElement(V.a,{mobileFeedback:!0,disabledFeedback:!0,style:ue({},this.getItemStyle(),{},!o.isSmallPhone&&{paddingLeft:12,paddingRight:12}),onClick:this.handleInsert,disabled:!e},ge.plusIcon,this.renderChevronDown()),r.createElement(V.a,{mobileFeedback:!0,disabledFeedback:!0,style:ue({},this.getItemStyle(),{fontWeight:m.a.fontWeight.medium}),onClick:e=>{this.stores.store.setState(ue({},this.stores.store.state,{isTurnIntoOpen:!0})),this.trackItemTap("turn_into")},disabled:!e},r.createElement(Z.FormattedMessage,{defaultMessage:"Turn into",id:"mobileActionBar.turnInto.buttonTitle"}),this.renderChevronDown()),r.createElement(E.a,{capture:!0,render:e=>r.createElement(V.a,Object.assign({mobileFeedback:!0,disabledFeedback:!0},e,{style:this.getItemStyle(),onClick:this.handleMention,disabled:!n}),r.createElement("span",{style:{fontSize:19,lineHeight:1,fontWeight:m.a.fontWeight.medium,marginBottom:o.isAndroid?4:0}},"@"))}),r.createElement(V.a,{mobileFeedback:!0,disabledFeedback:!0,style:this.getItemStyle(),onClick:this.handleComment,disabled:!t},ge.discussionIcon),r.createElement(V.a,{mobileFeedback:!0,disabledFeedback:!0,style:this.getItemStyle(),onClick:this.handleTakePicture,disabled:!e},ge.imageIcon),r.createElement(V.a,{mobileFeedback:!0,disabledFeedback:!0,style:this.getItemStyle(),onClick:this.handleDelete,disabled:!e},ge.trashIcon),this.renderBlockMovementActions(),this.renderBlockUndoActions(),r.createElement(V.a,{mobileFeedback:!0,disabledFeedback:!0,style:ue({},this.getItemStyle(),{fontWeight:m.a.fontWeight.medium}),onClick:e=>{this.stores.store.setState(ue({},this.stores.store.state,{isColorOpen:!0})),this.trackItemTap("color")},disabled:!e},r.createElement(Z.FormattedMessage,{defaultMessage:"Color",id:"mobileActionBar.color.buttonTitle"}),this.renderChevronDown()),r.createElement(V.a,{mobileFeedback:!0,disabledFeedback:!0,style:ue({},this.getItemStyle(),{fontWeight:m.a.fontWeight.medium}),onClick:this.handleMoreClick,disabled:!e},r.createElement(Z.FormattedMessage,{defaultMessage:"More",id:"mobileActionBar.more.buttonTitle"}),this.renderChevronDown()))}renderBlockMovementActions(){const e=this.canTriggerBlockActions.state,t=B.default.state.stores[0];return r.createElement("div",{style:ue({},this.getItemStyle(),{paddingLeft:6,paddingRight:6})},r.createElement(V.a,{mobileFeedback:!0,disabledFeedback:!0,style:ge.minorItemStyle,disabled:!e||!a.b(t),onClick:this.handleUnindent},ge.unindentIcon),r.createElement(V.a,{mobileFeedback:!0,disabledFeedback:!0,style:ge.minorItemStyle,disabled:!e||!a.a(t),onClick:this.handleIndent},ge.indentIcon),r.createElement(V.a,{mobileFeedback:!0,disabledFeedback:!0,style:ge.minorItemStyle,disabled:!e,onClick:this.handleMoveUp},ge.moveUpIcon),r.createElement(V.a,{mobileFeedback:!0,disabledFeedback:!0,style:ge.minorItemStyle,disabled:!e,onClick:this.handleMoveDown},ge.moveDownIcon))}renderBlockUndoActions(){return r.createElement("div",{style:ue({},this.getItemStyle(),{paddingLeft:6,paddingRight:6})},r.createElement(V.a,{mobileFeedback:!0,disabledFeedback:!0,style:ge.minorItemStyle,disabled:!l.b(),onClick:this.handleUndo},ge.undoIcon),r.createElement(V.a,{mobileFeedback:!0,disabledFeedback:!0,style:ge.minorItemStyle,disabled:!l.a(),onClick:this.handleRedo},ge.redoIcon))}renderTextActions(){const e=this.canTriggerTextActions.state,t=this.props.currentBlockStore.canComment();return r.createElement("div",{style:this.getActionMenuStyle(),onScroll:this.handleActionsScrollDebounced},r.createElement(w.a,{style:this.getItemStyle(),blockStore:B.default.state.stores[0],disabled:!t}),r.createElement(v.a,{type:"b",style:this.getItemStyle(),onClick:()=>this.trackItemTap("bold"),disabled:!e},r.createElement("span",{style:{fontWeight:m.a.fontWeight.semibold}},r.createElement(Z.FormattedMessage,{defaultMessage:"B",id:"mobileActionBar.bold.symbol",description:"Letter 'B' which represents 'bold' format option."}))),r.createElement(v.a,{type:"i",style:this.getItemStyle(),onClick:()=>this.trackItemTap("italic"),disabled:!e},r.createElement("span",{style:{fontStyle:"italic",fontWeight:m.a.fontWeight.semibold}},r.createElement(Z.FormattedMessage,{defaultMessage:"i",id:"mobileActionBar.italic.symbol",description:"Letter 'i' which represents 'italic' format option."}))),r.createElement(v.a,{type:"_",style:this.getItemStyle(),onClick:()=>this.trackItemTap("underline"),disabled:!e},r.createElement("span",{style:{textDecoration:"underline"}},r.createElement(Z.FormattedMessage,{defaultMessage:"U",id:"mobileActionBar.underline.symbol",description:"Letter 'U' which represents 'underline' format option."}))),r.createElement(v.a,{type:"s",style:this.getItemStyle(),onClick:()=>this.trackItemTap("strike_through"),disabled:!e},r.createElement("span",{style:{textDecoration:"line-through"}},r.createElement(Z.FormattedMessage,{defaultMessage:"S",id:"mobileActionBar.strikeThrough.symbol",description:"Letter 'S' which represents 'strike-through' format option."}))),r.createElement(v.a,{type:"c",style:this.getItemStyle(),onClick:()=>this.trackItemTap("code"),disabled:!e},r.createElement("span",{style:{fontFamily:m.a.fontFamily.githubMono}},r.createElement(Z.FormattedMessage,{defaultMessage:"Code",id:"mobileActionBar.code.symbol",description:"Word 'code' which represents 'code' format option."}))),r.createElement(k.a,{style:this.getItemStyle(),disabled:!e},r.createElement("span",{style:{borderBottom:"1px solid ".concat(this.theme.linkDecorationColor)}},r.createElement(Z.FormattedMessage,{defaultMessage:"Link",id:"mobileActionBar.link.symbol",description:"Word 'link' which represents 'link' format option."}))),r.createElement(ae.a,{onClick:()=>this.trackItemTap("equation"),disabled:!e,style:this.getItemStyle()},o.a.equation({width:16,height:16})),r.createElement(Q.a,{style:this.getItemStyle(),ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore,disabled:!e}))}renderTemplatesButton(){return r.createElement("div",{style:this.getActionMenuStyle()},r.createElement(V.a,{mobileFeedback:!0,disabledFeedback:!0,style:ue({},this.getItemStyle(),{borderRight:"none",fontWeight:m.a.fontWeight.medium}),onClick:e=>{this.stores.store.setState(ue({},this.stores.store.state,{isTemplatesOpen:!0})),this.trackItemTap("templates")}},o.a.templatesColor({width:20,marginRight:8}),r.createElement(Z.FormattedMessage,{defaultMessage:"Choose a template...",id:"mobileActionBar.templates.buttonTitle"}),this.renderChevronDown()))}renderInsertPopup(){const{device:e}=this.environment;return r.createElement(O.a,{capture:this.stores.store.state.isInsertOpen,ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:!1,render:t=>r.createElement(F.c,{popupType:e.isMobile?F.c.PopupType.SlideUp:F.c.PopupType.Popup,preventBlockRenderQueueOnEnter:!0,open:this.stores.store.state.isInsertOpen,keepFocus:!0,onDismiss:()=>{t(),this.handleCloseInsertPopup()},render:()=>r.createElement(S.b,{menuType:S.b.MenuType.Modal,title:r.createElement(Z.FormattedMessage,{defaultMessage:"Insert block",id:"mobileActionBar.insertBlock.modalTitle"}),right:r.createElement(se.CancelMenuText,null),onClickRight:()=>{t(),this.handleCloseInsertPopup()}},r.createElement(f.a,{sections:u.i,context:{environment:this.environment,blocks:B.default.state.stores},onAccept:this.handleCloseInsertPopup}))})})}renderTurnIntoPopup(){const{device:e}=this.environment;return r.createElement(O.a,{capture:this.stores.store.state.isTurnIntoOpen,ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:!0,render:()=>r.createElement(F.c,{popupType:e.isMobile?F.c.PopupType.SlideUp:F.c.PopupType.Popup,open:this.stores.store.state.isTurnIntoOpen,keepFocus:!0,onDismiss:this.handleCloseTurnIntoPopup,preventBlockRenderQueueOnEnter:!0,render:()=>r.createElement(S.b,{menuType:S.b.MenuType.Modal,title:r.createElement(Z.FormattedMessage,{defaultMessage:"Turn into",id:"mobileActionBar.turnInto.modalTitle"}),right:r.createElement(se.CancelMenuText,null),onClickRight:this.handleCloseTurnIntoPopup},r.createElement(f.a,{sections:[ue({},u.r,{title:""})],context:{environment:this.environment,blocks:B.default.state.stores},onAccept:this.handleCloseTurnIntoPopup}))})})}renderColorPopup(){const{device:e}=this.environment;return r.createElement(O.a,{capture:this.stores.store.state.isColorOpen,ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:!0,render:()=>r.createElement(F.c,{popupType:e.isMobile?F.c.PopupType.SlideUp:F.c.PopupType.Popup,open:this.stores.store.state.isColorOpen,keepFocus:!0,onDismiss:this.handleCloseColorPopup,preventBlockRenderQueueOnEnter:!0,render:()=>r.createElement(S.b,{menuType:S.b.MenuType.Modal,title:r.createElement(Z.FormattedMessage,{defaultMessage:"Block color",id:"mobileActionBar.blockColor.modalTitle"}),right:r.createElement(se.CancelMenuText,null),onClickRight:this.handleCloseColorPopup},r.createElement(f.a,{sections:[u.p,u.o,u.b],context:{environment:this.environment,blocks:B.default.state.stores},onAccept:this.handleCloseColorPopup}))})})}renderTemplatesPopup(){const{device:e}=this.environment;return r.createElement(O.a,{capture:this.stores.store.state.isTemplatesOpen,ignoreBlockSelection:!1,focusOffscreenInput:!1,restoreSelection:!1,render:()=>r.createElement(F.c,{popupType:e.isMobile?F.c.PopupType.SlideUp:F.c.PopupType.Popup,open:this.stores.store.state.isTemplatesOpen,keepFocus:!0,render:()=>r.createElement(S.b,{menuType:S.b.MenuType.Modal,title:r.createElement(Z.FormattedMessage,{defaultMessage:"Templates",id:"mobileActionBar.templates.modalTitle"}),right:r.createElement(se.CancelMenuText,null),onClickRight:this.handleCloseTemplatesPopup},r.createElement(K.a,{type:K.a.Type.Vertical,store:this.stores.templatePickerMenuListStore,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,onAccept:this.handleCloseTemplatesPopup,sections:[{key:"Basic",render:e=>r.createElement(ie.a,null,e.children),items:$.e.map(this.renderPageTemplatePickerItem)},{key:"Database",render:e=>r.createElement(ie.a,{title:r.createElement(Z.FormattedMessage,{defaultMessage:"Database",id:"mobileActionBar.databaseSection.title"})},e.children),items:$.a.filter(e=>e.shouldShow(this.environment)).map(this.renderPageTemplatePickerItem)},...ee.b(this.environment,this.props.intl).map(e=>({key:e.name,render:t=>r.createElement(ie.a,{title:e.name,key:e.name},t.children),items:e.items.map(this.renderMobileTemplatePreviewItem)}))]}))})})}renderChevronDown(){return o.a.chevronDown({width:10,marginLeft:4,fill:this.theme.lightIconColor})}isOpen(){const{device:e}=this.environment;return e.isMobileBrowser?this.stores.store.state.isOpen:this.shouldShow.state}trackItemTap(e){h.xe(this.environment,{itemName:e})}shouldShowTemplatesButton(){const{isPhone:e}=this.environment.device,t=this.props.currentBlockStore,n=Y.default.state.currentLoadingContainerStore,r=Boolean(t&&t.isCollectionView()),i=Boolean(t&&t.getParentCollectionStore()),o=this.environment.currentUser.isLoggedIn();return Boolean(!i&&!r&&e&&t&&n&&t.hasValue()&&t.canEdit()&&0===t.getContentIds().length&&o&&n.state.ready)}getItemBorder(){return"1px solid ".concat(this.theme.regularDividerColor)}getActionButtonStyles(){const{device:e,WindowSizeStore:t}=this.environment;return{height:"100%",width:"100%",fontSize:15,display:"flex",boxShadow:this.props.position===he.a.Bottom?this.theme.bottomActionBarShadow:this.theme.mediumBoxShadow,backgroundColor:this.theme.keyboardActionBarBackground,paddingLeft:e.isReactNative?t.state.paddingLeftCSS:0,paddingRight:e.isReactNative?t.state.paddingRightCSS:0}}getActionMenuStyle(){return{flexGrow:1,flexShrink:1,marginRight:-1,display:"flex",overflowX:"auto",overflowY:"hidden",WebkitOverflowScrolling:"touch"}}getItemStyle(){const{device:e}=this.environment;return{display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:e.isSmallPhone?8:10,paddingRight:e.isSmallPhone?8:10,borderRight:this.getItemBorder(),whiteSpace:"nowrap",height:ge.height,flexShrink:0,flexGrow:0,flexBasis:"auto",color:this.theme.regularTextColor,minWidth:e.isSmallPhone?42:44}}}ge.unindentIcon=o.a.indentDown({width:18,height:18,transform:"rotate(90deg)",position:"relative",left:1}),ge.indentIcon=o.a.indentDown({width:18,height:18,transform:"rotate(-90deg)",position:"relative",left:-1}),ge.moveUpIcon=o.a.moveUp({width:18,height:18,position:"relative",left:2}),ge.moveDownIcon=o.a.moveUp({width:18,height:18,transform:"rotate(180deg)",position:"relative",left:2}),ge.undoIcon=o.a.undo({width:19,height:19}),ge.redoIcon=o.a.redo({width:19,height:19}),ge.trashIcon=o.a.trash({width:18,height:18}),ge.discussionIcon=o.a.speechBubbleThin({width:18,height:18}),ge.plusIcon=o.a.thinPlus({width:14,height:14}),ge.keyboardIcon=o.a.keyboard({width:18,height:18}),ge.imageIcon=o.a.image({width:18,height:18}),ge.height=42,ge.minorItemStyle={width:34,justifyContent:"center"};t.default=Object(Z.injectIntl)(ge)},tCjx:function(e,t,n){"use strict";n.r(t);n("ioFf"),n("rGqo");var r=n("q1tI"),i=n("wldR"),o=n("MeYt"),s=n("FcJC"),a=n("mF3+"),l=n("QcDD"),c=n("ikHm"),d=n("4aFz"),h=n("id5p"),m=n("y6Dp"),u=n("CaJT"),p=n("HTFi");function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class S extends i.a{constructor(){super(...arguments),this.handleClickFind=()=>{d.c({environment:this.environment,analyticsFrom:"mobile-bottom-bar"}),m.ye(this.environment,{itemName:"search"})},this.handleClickQuickAdd=()=>{s.quickAddPage({environment:this.environment,from:"mobile_bottom_bar"}),m.ye(this.environment,{itemName:"add_page"})},this.handleUndo=()=>{u.f(this.environment,!0),m.ye(this.environment,{itemName:"undo"})},this.handleRedo=()=>{u.e(this.environment,!0),m.ye(this.environment,{itemName:"redo"})},this.canQuickAdd=this.createComputedStore(()=>Boolean(l.default.state.currentSpaceStore&&l.default.state.currentSpaceStore.canEdit()))}renderComponent(){const e=p.a.state;if(e){const{isTablet:t}=this.environment.device;return r.createElement("div",{style:this.getWrapStyle(e)},t?this.renderTabletButtons():this.renderPhoneButtons())}}renderPhoneButtons(){return r.createElement(r.Fragment,null,this.renderSearchButton(),this.renderUpdatesButton(),this.renderQuickAddPageButton())}renderTabletButtons(){return r.createElement(r.Fragment,null,this.renderSearchButton(),this.renderUpdatesButton(),this.renderQuickAddPageButton(),this.renderUndoRedoButtons())}renderSearchButton(){return r.createElement(o.a,{style:this.getSearchButtonStyle(),onClick:this.handleClickFind,mobileFeedback:!0},a.a.mobileBottomBarSearch(this.getIconStyle()))}renderUpdatesButton(){const{isTablet:e}=this.environment.device;return r.createElement(h.a,{format:e?h.a.Format.MobileBottomBarTablet:h.a.Format.MobileBottomBarPhone})}renderQuickAddPageButton(){return r.createElement(o.a,{style:this.getQuickAddButtonStyle(),onClick:this.handleClickQuickAdd,mobileFeedback:!0,disabled:!this.canQuickAdd.state,disabledFeedback:!0},a.a.mobileBottomBarAddPage(this.getIconStyle()))}renderUndoRedoButtons(){return r.createElement(r.Fragment,null,r.createElement(o.a,{style:this.getUndoButtonStyle(),onClick:this.handleUndo,mobileFeedback:!0,disabled:!u.b(),disabledFeedback:!0},a.a.mobileBottomBarUndo(this.getIconStyle())),r.createElement(o.a,{style:this.getRedoButtonStyle(),onClick:this.handleRedo,mobileFeedback:!0,disabled:!u.a(),disabledFeedback:!0},a.a.mobileBottomBarRedo(this.getIconStyle())))}getWrapStyle(e){const{WindowSizeStore:t}=this.environment,{isTablet:n}=this.environment.device;return{position:"absolute",left:0,right:0,bottom:0,display:"flex",justifyContent:n?"flex-start":"space-around",height:t.getSafePaddingBottomCSS(S.height),paddingBottom:t.state.paddingBottomCSS,background:this.theme.contentBackground,borderTop:"1px ".concat(this.theme.darkDividerColor," solid"),zIndex:c.k,opacity:e?1:0,pointerEvents:e?"auto":"none",cursor:"pointer"}}getSearchButtonStyle(){const{WindowSizeStore:e}=this.environment,{isTablet:t}=this.environment.device;return b({display:"flex",alignItems:"center",justifyContent:"flex-start",flex:1,paddingLeft:e.getSafePaddingLeftCSS(18)},t&&{flex:"none",paddingLeft:2,width:S.tabletButtonWidth,justifyContent:"center"})}getQuickAddButtonStyle(){const{WindowSizeStore:e}=this.environment,{isTablet:t}=this.environment.device;return b({display:"flex",alignItems:"center",justifyContent:"flex-end",flex:1,paddingRight:e.getSafePaddingRightCSS(18)},t&&{justifyContent:"center",flex:"none",paddingRight:0,width:S.tabletButtonWidth,marginRight:"auto"})}getUndoButtonStyle(){const{WindowSizeStore:e}=this.environment;return{display:"flex",alignItems:"center",justifyContent:"flex-start",flex:"none",paddingLeft:e.getSafePaddingLeftCSS(18),width:S.tabletButtonWidth}}getRedoButtonStyle(){return{display:"flex",alignItems:"center",justifyContent:"center",flex:"none",width:S.tabletButtonWidth,paddingRight:4}}getIconStyle(){return{width:26,fill:this.theme.regularTextColor}}}S.height=44,S.tabletButtonWidth=54,t.default=S}}]);